<!-- ‚úÖ FILE: index.html (COPY/PASTE THIS WHOLE FILE)
     This version is GUARANTEED to align with your current main.ts:
     - Adds ALL required IDs (authEmail/authPassword/signUpBtn/logInBtn/logOutBtn/authStatusPill)
     - Adds Library + Favorite UI (favoriteBtn/openLibraryBtn/closeLibraryBtn/outputView/libraryView/librarySearch/libraryList)
     - Adds landingView + appView + anonKey_app + logOutBtn_app + message_app (optional wrappers your TS supports)
     - Fixes grade/subject to be <select> (your main.ts expects HTMLSelectElement for grade + subject)
     - Keeps your existing styling + output formatting + billing button + pdf-lib
-->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Lessons-Ready</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- ‚úÖ Stripe.js (REQUIRED for Checkout) -->
    <script src="https://js.stripe.com/v3/"></script>

    <!-- Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --bg: #0b1020;
        --panel: rgba(255, 255, 255, 0.06);
        --border: rgba(255, 255, 255, 0.12);
        --text: rgba(255, 255, 255, 0.92);
        --muted: rgba(255, 255, 255, 0.65);
        --accent: #7c5cff;
        --accent2: #2be7ff;
        --danger: rgba(255, 90, 90, 0.18);
        --dangerBorder: rgba(255, 90, 90, 0.35);
        --ok: rgba(56, 255, 143, 0.12);
        --okBorder: rgba(56, 255, 143, 0.28);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: Inter, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, Helvetica, Arial, sans-serif;
        color: var(--text);
        background: radial-gradient(
            900px 600px at 20% 20%,
            rgba(124, 92, 255, 0.3),
            transparent 60%
          ),
          radial-gradient(
            900px 600px at 80% 20%,
            rgba(43, 231, 255, 0.18),
            transparent 60%
          ),
          radial-gradient(
            900px 700px at 50% 100%,
            rgba(56, 255, 143, 0.1),
            transparent 55%
          ),
          var(--bg);
      }

      .shell {
        max-width: 1100px;
        margin: 0 auto;
        padding: 24px;
      }

      .topbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        padding: 16px 18px;
        border: 1px solid var(--border);
        background: linear-gradient(180deg, var(--panel), transparent);
        border-radius: 16px;
        backdrop-filter: blur(10px);
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        box-shadow: 0 10px 30px rgba(124, 92, 255, 0.25);
      }

      h1 {
        font-size: 18px;
        margin: 0;
        letter-spacing: 0.2px;
      }
      .tagline {
        margin: 2px 0 0;
        font-size: 13px;
        color: var(--muted);
      }

      .pill {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 8px 10px;
        border: 1px solid var(--border);
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.04);
        color: var(--muted);
        font-size: 12px;
        white-space: nowrap;
      }

      .grid {
        display: grid;
        grid-template-columns: 420px 1fr;
        gap: 16px;
        margin-top: 16px;
      }

      .panel {
        border: 1px solid var(--border);
        background: linear-gradient(180deg, var(--panel), rgba(255, 255, 255, 0.03));
        border-radius: 16px;
        padding: 16px;
        backdrop-filter: blur(10px);
      }

      .sectionTitle {
        font-size: 13px;
        color: var(--muted);
        text-transform: uppercase;
        letter-spacing: 0.12em;
        margin: 10px 0 10px;
      }

      .heroBox {
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.03);
        border-radius: 16px;
        padding: 14px;
        margin-bottom: 14px;
      }

      .heroHeadline {
        font-size: 16px;
        font-weight: 800;
        margin: 0 0 6px;
      }
      .heroSub {
        margin: 0;
        color: var(--muted);
        font-size: 13px;
        line-height: 1.45;
      }

      .formGrid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }

      label {
        display: grid;
        gap: 6px;
        font-size: 13px;
        color: var(--muted);
      }

      input,
      select {
        width: 100%;
        padding: 11px 12px;
        border-radius: 12px;
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.04);
        color: var(--text);
        outline: none;
        font-family: inherit;
      }

      input::placeholder {
        color: rgba(255, 255, 255, 0.45);
      }

      input:focus,
      select:focus {
        border-color: rgba(124, 92, 255, 0.55);
        box-shadow: 0 0 0 3px rgba(124, 92, 255, 0.15);
      }

      option {
        color: #111;
      }

      .full {
        grid-column: 1 / -1;
      }

      .rowInline {
        display: flex;
        gap: 12px;
        align-items: center;
        justify-content: space-between;
        padding: 12px;
        border: 1px solid var(--border);
        border-radius: 14px;
        background: rgba(255, 255, 255, 0.03);
      }

      .toggle {
        display: flex;
        align-items: center;
        gap: 10px;
        color: var(--muted);
        font-size: 13px;
      }
      .toggle input {
        width: 18px;
        height: 18px;
      }

      .btnRow {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        justify-content: flex-end;
      }

      button {
        border: 0;
        border-radius: 14px;
        padding: 12px 14px;
        cursor: pointer;
        font-weight: 600;
        font-family: inherit;
      }

      .primary {
        flex: 1;
        color: white;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        box-shadow: 0 12px 30px rgba(124, 92, 255, 0.22);
      }

      .secondary {
        color: var(--text);
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid var(--border);
      }

      .billing {
        color: white;
        background: rgba(124, 92, 255, 0.25);
        border: 1px solid rgba(124, 92, 255, 0.45);
      }

      .dangerBtn {
        color: rgba(255, 255, 255, 0.9);
        background: rgba(255, 90, 90, 0.18);
        border: 1px solid rgba(255, 90, 90, 0.35);
      }

      button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .msg {
        margin-top: 12px;
      }
      .ok {
        background: var(--ok);
        border: 1px solid var(--okBorder);
        border-radius: 14px;
        padding: 12px;
      }
      .error {
        background: var(--danger);
        border: 1px solid var(--dangerBorder);
        border-radius: 14px;
        padding: 12px;
      }

      .outputHeader {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        margin-bottom: 10px;
      }

      .outputHeader h2 {
        margin: 0;
        font-size: 16px;
      }
      .outputMeta {
        color: var(--muted);
        font-size: 12px;
      }

      #output {
        margin: 0;
        padding: 14px;
        border-radius: 16px;
        border: 1px solid var(--border);
        background: rgba(0, 0, 0, 0.35);
        color: rgba(255, 255, 255, 0.92);
        line-height: 1.5;
        min-height: 420px;
        font-size: 14px;
        overflow: auto;
      }

      #output.typing {
        white-space: pre-wrap;
      }

      #output p {
        margin: 8px 0;
      }
      #output ul,
      #output ol {
        margin: 8px 0 8px 18px;
      }
      #output li {
        margin: 6px 0;
      }
      #output b {
        color: rgba(255, 255, 255, 0.98);
      }

      .secHead {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        margin: 14px 0 10px;
        border: 1px solid var(--border);
        border-radius: 14px;
        background: rgba(255, 255, 255, 0.04);
      }
      .secIcon {
        font-size: 18px;
      }
      .secTitle {
        font-weight: 800;
        letter-spacing: -0.01em;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin: 10px 0 14px;
        overflow: hidden;
        border-radius: 14px;
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.03);
      }
      th,
      td {
        padding: 10px 10px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        vertical-align: top;
      }
      th {
        text-align: left;
        font-weight: 800;
        background: rgba(255, 255, 255, 0.04);
      }

      /* ‚úÖ Library */
      .libraryTopRow {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
        margin-bottom: 10px;
      }

      .libraryCard {
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.03);
        border-radius: 14px;
        padding: 12px;
        margin: 10px 0;
      }

      .libraryTop {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: 12px;
      }

      .libraryTitle {
        font-weight: 800;
        margin-bottom: 4px;
      }

      .libraryMeta {
        color: var(--muted);
        font-size: 12px;
      }

      .libraryBtns {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        justify-content: flex-end;
      }

      .smallBtn {
        padding: 9px 10px;
        border-radius: 12px;
        font-size: 12px;
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid var(--border);
        color: var(--text);
      }

      .smallBtn.danger {
        background: rgba(255, 90, 90, 0.18);
        border: 1px solid rgba(255, 90, 90, 0.35);
      }

      .smallBtn.star {
        background: rgba(124, 92, 255, 0.18);
        border: 1px solid rgba(124, 92, 255, 0.35);
      }

      /* ‚úÖ Auth cards */
      .authBox {
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.03);
        border-radius: 16px;
        padding: 12px;
        margin-bottom: 12px;
      }

      .authRow {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 10px;
      }

      .authActions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 10px;
      }

      .monoPill {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        font-size: 12px;
      }

      @media (max-width: 980px) {
        .grid {
          grid-template-columns: 1fr;
        }
        #output {
          min-height: 340px;
        }
        .pill {
          display: none;
        }
      }
    </style>
  </head>

  <body>
    <div class="shell">
      <div class="topbar">
        <div class="brand">
          <div class="logo"></div>
          <div>
            <h1>Lessons-Ready</h1>
            <div class="tagline">
              Lessons that are standards-aligned, admin-safe, and ready to teach‚Äîfast.
            </div>
          </div>
        </div>
        <div class="pill">‚ö° Fast output ‚Ä¢ üõ°Ô∏è Admin-safe by design ‚Ä¢ ‚úçÔ∏è Original examples</div>
      </div>

      <div class="grid">
        <!-- LEFT: Inputs + Auth -->
        <div class="panel">
          <div class="heroBox">
            <div class="heroHeadline">Turn standards into a complete, teachable lesson in seconds.</div>
            <p class="heroSub">
              Generates a full lesson cycle with checks for understanding and misconception support‚Äîwithout copying proprietary passages.
            </p>
          </div>

          <!-- ‚úÖ LANDING VIEW (shows when logged OUT) -->
          <div id="landingView" style="display:block;">
            <div class="sectionTitle">Account</div>

            <div class="authBox">
              <div class="pill monoPill" id="authStatusPill">Not logged in</div>

              <div class="authRow">
                <label class="full">
                  Email
                  <input id="authEmail" type="email" placeholder="you@school.org" />
                </label>

                <label class="full">
                  Password
                  <input id="authPassword" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
                </label>
              </div>

              <div class="authActions">
                <button class="secondary" id="signUpBtn" type="button">Sign Up</button>
                <button class="secondary" id="logInBtn" type="button">Log In</button>
                <button class="dangerBtn" id="logOutBtn" type="button" style="display:none;">Log Out</button>
              </div>

              <div class="msg" id="message"></div>
            </div>

            <div class="sectionTitle">Setup</div>
            <div class="formGrid">
              <label class="full">
                Supabase anon key (public)
                <input
                  id="anonKey"
                  placeholder="Paste anon/public key here (Supabase ‚Üí Settings ‚Üí API)"
                />
              </label>

              <label>
                Mode
                <select id="mode">
                  <option value="lite" selected>Fast (Lite)</option>
                  <option value="full">Detailed (Full)</option>
                </select>
              </label>

              <label>
                State
                <select id="state">
                  <option value="" selected>Select state</option>
                  <option value="AL">Alabama</option>
                  <option value="AK">Alaska</option>
                  <option value="AZ">Arizona</option>
                  <option value="AR">Arkansas</option>
                  <option value="CA">California</option>
                  <option value="CO">Colorado</option>
                  <option value="CT">Connecticut</option>
                  <option value="DE">Delaware</option>
                  <option value="DC">District of Columbia</option>
                  <option value="FL">Florida</option>
                  <option value="GA">Georgia</option>
                  <option value="HI">Hawaii</option>
                  <option value="ID">Idaho</option>
                  <option value="IL">Illinois</option>
                  <option value="IN">Indiana</option>
                  <option value="IA">Iowa</option>
                  <option value="KS">Kansas</option>
                  <option value="KY">Kentucky</option>
                  <option value="LA">Louisiana</option>
                  <option value="ME">Maine</option>
                  <option value="MD">Maryland</option>
                  <option value="MA">Massachusetts</option>
                  <option value="MI">Michigan</option>
                  <option value="MN">Minnesota</option>
                  <option value="MS">Mississippi</option>
                  <option value="MO">Missouri</option>
                  <option value="MT">Montana</option>
                  <option value="NE">Nebraska</option>
                  <option value="NV">Nevada</option>
                  <option value="NH">New Hampshire</option>
                  <option value="NJ">New Jersey</option>
                  <option value="NM">New Mexico</option>
                  <option value="NY">New York</option>
                  <option value="NC">North Carolina</option>
                  <option value="ND">North Dakota</option>
                  <option value="OH">Ohio</option>
                  <option value="OK">Oklahoma</option>
                  <option value="OR">Oregon</option>
                  <option value="PA">Pennsylvania</option>
                  <option value="RI">Rhode Island</option>
                  <option value="SC">South Carolina</option>
                  <option value="SD">South Dakota</option>
                  <option value="TN">Tennessee</option>
                  <option value="TX">Texas</option>
                  <option value="UT">Utah</option>
                  <option value="VT">Vermont</option>
                  <option value="VA">Virginia</option>
                  <option value="WA">Washington</option>
                  <option value="WV">West Virginia</option>
                  <option value="WI">Wisconsin</option>
                  <option value="WY">Wyoming</option>
                </select>
              </label>
            </div>

            <div class="sectionTitle">Curriculum context</div>
            <div class="formGrid">
              <label class="full">
                Select Curriculum Publisher
                <select id="publisher">
                  <option value="Bluebonnet Learning (TX OER)" selected>Bluebonnet Learning (TX OER)</option>
                  <option value="Houghton Mifflin Harcourt (HMH)">Houghton Mifflin Harcourt (HMH)</option>
                  <option value="McGraw Hill">McGraw Hill</option>
                  <option value="Savvas / Pearson">Savvas / Pearson</option>
                  <option value="Curriculum Associates (i-Ready)">Curriculum Associates (i-Ready)</option>
                  <option value="Great Minds">Great Minds</option>
                  <option value="Amplify">Amplify</option>
                  <option value="EL Education">EL Education</option>
                  <option value="OpenSciEd">OpenSciEd</option>
                  <option value="CKLA / Core Knowledge">CKLA / Core Knowledge</option>
                  <option value="Open Up Resources">Open Up Resources</option>
                  <option value="Imagine Learning">Imagine Learning</option>
                  <option value="Lexia">Lexia</option>
                  <option value="Achieve3000">Achieve3000</option>
                  <option value="Edmentum">Edmentum</option>
                  <option value="Discovery Education">Discovery Education</option>
                  <option value="TCI (Social Studies)">TCI (Social Studies)</option>
                  <option value="District-Created Curriculum">District-Created Curriculum</option>
                  <option value="Teacher-Created / PLC">Teacher-Created / PLC</option>
                  <option value="Hybrid / Multiple Curricula">Hybrid / Multiple Curricula</option>
                  <option value="Other">Other</option>
                </select>
              </label>

              <label class="full" id="publisherOtherWrap" style="display:none;">
                If Other, type curriculum name
                <input id="publisherOther" placeholder="Type publisher/curriculum name" />
              </label>

              <!-- ‚úÖ FIXED: main.ts expects <select> -->
              <label>
                Grade
                <select id="grade">
                  <option value="0">K</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4" selected>4</option>
                  <option value="5">5</option>
                  <option value="6">6</option>
                  <option value="7">7</option>
                  <option value="8">8</option>
                  <option value="9">9</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                </select>
              </label>

              <label>
                Subject
                <select id="subject">
                  <option value="ELAR" selected>ELAR</option>
                  <option value="Math">Math</option>
                  <option value="Science">Science</option>
                  <option value="Social Studies">Social Studies</option>
                </select>
              </label>

              <label class="full">
                Standard
                <input id="standard" value="TEKS 4.8B" />
              </label>

              <label>
                Unit
                <input id="unit" value="Unit 1" />
              </label>

              <label>
                Lesson
                <input id="lesson" value="Lesson 2" />
              </label>
            </div>

            <div class="sectionTitle">Controls</div>
            <div class="rowInline">
              <div class="toggle">
                <input type="checkbox" id="testMode" />
                <span>Test Mode (skip OpenAI)</span>
              </div>

              <div class="btnRow">
                <button class="billing" id="billingBtn" type="button">Start Free Trial</button>

                <button class="secondary" id="openLibraryBtn" type="button">Library</button>
                <button class="secondary" id="closeLibraryBtn" type="button" style="display:none;">Close</button>

                <button class="secondary" id="copyBtn" type="button">Copy</button>
                <button class="secondary" id="downloadPdfBtn" type="button" disabled>Download PDF</button>
                <button class="primary" id="generateBtn" type="button">Generate</button>
              </div>
            </div>
          </div>

          <!-- ‚úÖ APP VIEW (shows when logged IN) -->
          <div id="appView" style="display:none; margin-top: 14px;">
            <div class="sectionTitle">Logged in</div>

            <div class="authBox">
              <div class="pill monoPill" id="authStatusPill_app" style="display:none;"></div>

              <label class="full">
                Supabase anon key (public)
                <input
                  id="anonKey_app"
                  placeholder="Anon key (synced from above)"
                />
              </label>

              <div class="authActions">
                <button class="dangerBtn" id="logOutBtn_app" type="button">Log Out</button>
              </div>

              <div class="msg" id="message_app"></div>
            </div>
          </div>
        </div>

        <!-- RIGHT: Output + Library Views -->
        <div class="panel">
          <div class="outputHeader">
            <div>
              <h2>Lessons-Ready Output</h2>
              <div class="outputMeta" id="metaLine">Ready when you are.</div>
            </div>
            <div class="pill" id="statusPill">Idle</div>
          </div>

          <!-- ‚úÖ Output view wrapper (required by main.ts) -->
          <div id="outputView">
            <div style="display:flex; gap:10px; align-items:center; margin-bottom:10px; flex-wrap:wrap;">
              <button class="secondary" id="favoriteBtn" type="button" disabled>‚òÜ Favorite</button>
            </div>

            <div id="output">(nothing yet)</div>
          </div>

          <!-- ‚úÖ Library view wrapper (required by main.ts) -->
          <div id="libraryView" style="display:none;">
            <div class="libraryTopRow">
              <div class="pill">üìö Your saved lessons</div>
              <input
                id="librarySearch"
                placeholder="Search by standard, unit, publisher, keyword‚Ä¶"
                style="max-width: 420px;"
              />
            </div>

            <div id="libraryList"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚úÖ PDF library -->
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>

    <!-- ‚úÖ Your app -->
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>

